@model CarouselArticleViewModel

@{
    ViewData["Title"] = "Zpravodajství";
    ViewData["ShowFooter"] = true;
}

@if (Model?.Carousels?.Count > 0)
{
    <div class="hero-section">
        <div id="mainCarousel" class="carousel slide carousel-fade" data-bs-ride="carousel">
            <div class="carousel-indicators">
                @for (int i = 0; i < Model.Carousels.Count; i++)
                {
                    <button type="button" data-bs-target="#mainCarousel" 
                            data-bs-slide-to="@i" class="@(i == 0 ? "active" : "")"
                            aria-current="@(i == 0 ? "true" : "false")" 
                            aria-label="Slide @(i + 1)"></button>
                }
            </div>
            <div class="carousel-inner">
                @{
                    string active = "active";
                    foreach (var carousel in Model.Carousels)
                    {
                        <div class="carousel-item @active" data-bs-interval="5000">
                            <a asp-controller="Articles" asp-action="Detail" asp-route-id="@carousel.ArticleId" class="overlay-container">
                                <img src="@carousel.ImageSrc" class="d-block w-100" alt="@carousel.ImageAlt">
                                <div class="carousel-caption">
                                    <h2 class="display-4 fw-bold text-shadow">@carousel.ImageAlt</h2>
                                </div>
                            </a>
                        </div>
                        active = string.Empty;
                    }
                }
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#mainCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#mainCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </div>
}

@if (Model?.Articles?.Count > 0)
{
    <div class="container-fluid py-5">
        <div class="row">
            <div class="col-12 col-lg-3 mb-4">
                <div class="card border-0 shadow-sm sticky-top" style="top: 5rem;">
                    <div class="card-header bg-primary text-white py-3">
                        <h5 class="mb-0">
                            <i class="fas fa-filter me-2"></i>Filtry
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="d-flex flex-column gap-2">
                            <button class="tag-button btn btn-outline-primary w-100 active" data-filter="all">
                                <i class="fas fa-globe me-2"></i>Všechny články
                            </button>
                            <h6 class="mt-3 mb-2">Kategorie:</h6>
                            @foreach (var category in Model.Categories)
                            {
                                <button class="tag-button btn btn-outline-primary w-100" 
                                        data-category="@category.Id" 
                                        data-category-name="@category.Name">
                                    <i class="fas fa-tag me-2"></i>@category.Name
                                </button>
                            }
                            <h6 class="mt-3 mb-2">Tagy:</h6>
                            @foreach (var tag in Model.Tags)
                            {
                                <button class="tag-button btn btn-outline-secondary w-100" data-tag="@tag.Id">
                                    <i class="fas fa-hashtag me-2"></i>@tag.Name
                                </button>
                            }
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-12 col-lg-9">
                <div class="row g-4">
                    @if (Model.Articles.Any())
                    {
                        var mainArticle = Model.Articles.First();
                        <div class="col-12 mb-4">
                            <div class="card border-0 shadow-sm featured-article">
                                <div class="row g-0">
                                    <div class="col-md-8">
                                        <div class="position-relative h-100">
                                            @if (!string.IsNullOrEmpty(mainArticle.ImageSrc))
                                            {
                                                <img src="@mainArticle.ImageSrc" class="w-100 h-100 object-fit-cover" 
                                                     style="min-height: 400px;" alt="@mainArticle.Title">
                                            }
                                            <div class="position-absolute top-0 start-0 m-3">
                                                <span class="badge bg-primary">
                                                    <i class="fas fa-star me-1"></i>Hlavní článek
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="card-body h-100 d-flex flex-column">
                                            <h3 class="card-title mb-3">@mainArticle.Title</h3>
                                            <p class="card-text flex-grow-1">@mainArticle.Description</p>
                                            <div class="mt-auto">
                                                <a asp-controller="Articles" asp-action="Detail" asp-route-id="@mainArticle.Id" 
                                                   class="btn btn-outline-primary rounded-pill w-100">
                                                    <i class="fas fa-book-reader me-2"></i>Číst více
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }

                    @foreach (var article in Model.Articles.Skip(1))
                    {
                        <div class="col-12 col-md-6 col-xl-4 article-card" 
                             data-category="@article.CategoryID" 
                             data-tags="@string.Join(",", article.ArticleTags?.Select(tag => tag.Tag?.Id.ToString()))">
                            <div class="card h-100 border-0 shadow-sm hover-lift">
                                <div class="position-relative">
                                    @if (!string.IsNullOrEmpty(article.ImageSrc))
                                    {
                                        <img src="@article.ImageSrc" class="card-img-top rounded-top" alt="@article.Title" 
                                              style="height: 200px; object-fit: cover;">
                                    }
                                    <div class="position-absolute top-0 start-0 p-3">
                                        <span class="badge bg-primary rounded-pill">
                                            <i class="fas fa-tag me-1"></i>@article.Category?.Name
                                        </span>
                                    </div>
                                </div>
                                <div class="card-body d-flex flex-column">
                                    <h5 class="card-title mb-3">@article.Title</h5>
                                    <p class="card-text text-muted flex-grow-1">@article.Description</p>
                                    <div class="mt-auto">
                                        @if (article.ArticleTags != null)
                                        {
                                            <div class="mb-3">
                                                @foreach (var articleTag in article.ArticleTags)
                                                {
                                                    <span class="badge bg-light text-dark me-1">
                                                        <i class="fas fa-hashtag me-1"></i>@articleTag.Tag?.Name
                                                    </span>
                                                }
                                            </div>
                                        }
                                        <a asp-controller="Articles" asp-action="Detail" asp-route-id="@article.Id" 
                                           class="btn btn-outline-primary rounded-pill w-100">
                                            <i class="fas fa-arrow-right me-1"></i>Číst více
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
}

@section Styles {
    <link rel="stylesheet" href="~/css/content.css" />
}
 
<script src="~/js/site.js"></script>
